clear
%以下为确定ns和nb的取值范围、步长，绘制底面二维坐标
nb=5:0.1:10;
ns=5:0.1:15;
%赋值hn和N
hn=5;
N=10;
[X,Y]=meshgrid(ns,nb);
%建立一个空矩阵I1，根据步长确定矩阵的行数列数
I=zeros(51,101);
%定义p0和p1，相当于函数的exp(-t0)和exp(-t1)
p0=pfun2(0,X,Y,hn);
p1=pfun2(1,X,Y,hn);
p2=pfun2(1,X,-Y,hn);
A=0.5*(N*(1.-p0).*((log2((1.-p0)./(1.-p1)))-(ns.*hn/N).*log2(exp(0)))+ns.*hn*log2(exp(0)));
%利用泰勒展开求解B
B=0.5*log2(exp(0))*(1.+(((1.-p0).^2./(1.-p1))+p2).^N);
%计算I并求值，乘10代表着Z=10
I=(1-B+A)*10;
surf(X,Y,I);